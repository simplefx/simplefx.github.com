<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
   <title>Joins : Simple.Data Help</title>
   <link rel="stylesheet/less" type="text/css" href="../../less/metro.less" />
   <script type="text/javascript" src="../../scripts/less-1.3.0.min.js"></script>
</head>
<body>
   <h1><a href="../../index.html" title="Back to index">Simple.Data</a></h1>
   <section>
        Simple.Data defines a number of commands for retrieving data from a data store. These can then be daisychained in a LINQ-like fashion with further methods to modify the basic query. 
        For example, there are two ways to join together data tables as you would in SQL using INNER JOIN.
    </section>
<h2>Joins</h2>
<p>There are two ways that you can perform joins with Simple.Data, Explicit Join and Natural Join. An Explicit Join allows you to 
specify the indenty columns that are used in the Join. A Natural Join requires referential integrity, and uses the Foreign Key
constraints on the tables.</p>

<h3>Explicit Join</h3>
<p>There are two forms of Explicit Join, using Named Parameters and using the On(...) form</p>

<h4>Named Parameters form</h4>
<pre class="brush: csharp">
var q = _db.Employees.Query()
.Join(_db.Department, Id: _db.Employees.DepartmentId)
.Select(_db.Employees.Name, _db.Department.Name.As("Department"));
</pre>
<p>Generates the following SQL</p>
<pre class="brush: sql">
select [dbo].[employee].[name],
        [dbo].[department].[name] as [Department] 
from [dbo].[employee]
join [dbo].[department] 
    on ([dbo].[department].[id] = [dbo].[employee].[departmentid])
</pre>
<h4>On(...) form</h4>
<pre class="brush: csharp">
var q = _db.Employees.Query()
.Join(_db.Department).On(_db.Department.Id == _db.Employees.DepartmentId)
.Select(_db.Employees.Name, _db.Department.Name.As("Department"));
</pre>
<p>Generates the following SQL</p>
<pre class="brush: sql">
select [dbo].[employee].[name],
        [dbo].[department].[name] as [Department] 
from [dbo].[employee]
join [dbo].[department] 
    on ([dbo].[department].[id] = [dbo].[employee].[departmentid])
</pre>
<h3>Natural Joins</h3>
<p>There are two forms of natural joins, the dynamic form and via indexers.</p>
<h4>Natural Join (Dynamic form)</h4>
<pre class="brush: csharp">
_db.Employees.Find(_db.Employees.DepartmentId == _db.Department.Id)
.Select(_db.Employees.Name, _db.Department.Name.As("Department"));
</pre>
<p>Generates the following SQL</p>
<pre class="brush: sql">
   
select [dbo].[employee].[name],
    [dbo].[department].[name] as [Department] 
from [dbo].[employee]
join [dbo].[department] 
    on ([dbo].[department].[id] = [dbo].[employee].[departmentid])</pre>
<h4>Natural Join (Indexers form)</h4>
<pre class="brush: csharp">
var orderDate = new DateTime(2010, 1, 1);
_db["Customer"].Find(_db["Customers"]["Orders"]["OrderDate"] == orderDate);
</pre>
<p>Generates the following SQL</p>
<pre class="brush: sql">
@p1 (Object) = 01/01/2010 00:00:00
select [dbo].[Customer].* from [dbo].[Customer] 
join [dbo].[Orders] 
    on ([dbo].[Customer].[CustomerId] = [dbo].[Orders].[CustomerId]) 
where [dbo].[Orders].[OrderDate] = @p1</pre>
</body>
</html>
