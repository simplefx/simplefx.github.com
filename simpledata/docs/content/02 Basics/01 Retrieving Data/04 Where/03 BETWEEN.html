<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>BETWEEN and NOT BETWEEN</title>
</head>
<body>
<h2>Finding rows that have a value between two values</h2>
<p>Simple.Data supports the use of the <code class="method">to</code> method to create integer and datetime ranges which should (not) contain a field value, generating a BETWEEN or NOT BETWEEN clause as appropriate.</p>
As this translates to equating a field to a range of values, we can generate an BETWEEN clause in several ways. For example</p>
<pre class="brush:csharp">//Add this using statement to use the to function
using Simple.Data;

// Embedded in a FindAllBy* or FindBy* method
db.Albums.FindAllByAlbumId(400.to(410)));

// As part of the SimpleExpression parameter for Find or FindAll
db.Albums.FindAll(db.Albums.AlbumId == 400.to(410)));

// As part of the SimpleExpression parameter for Where
db.Albums.All().Where(db.Albums.AlbumId == 400.to(410)));</pre>
<p>All three calls generate the same SQL statement</p>
<pre class="brush:sql">
select * from [dbo].[Album] 
WHERE [dbo].[Album].[AlbumId] BETWEEN @p1_start AND @p1_end

@p1_start (Int32) = 400
@p1_end (Int32) = 410</pre>
<p>A NOT BETWEEN clause is written as an inequality statement so can only be created in two ways as FindAllBy* and FindBy* only support equality expressions.</p>
<pre class="brush:csharp">//Add this using statement to use the to function
using Simple.Data;

// As part of the SimpleExpression parameter for Find or FindAll
db.Orders.FindAll(
   db.Orders.OrderDate != SqlDateTime.MinValue.Value.to(DateTime.Now)));

// As part of the SimpleExpression parameter for Where
db.Orders.All().Where(
   db.Orders.OrderDate != SqlDateTime.MinValue.Value.to(DateTime.Now)));</pre>
<p>Both calls generate the same SQL statement</p>
<pre class="brush:sql">select * from [dbo].[Order] 
WHERE [dbo].[Order].[OrderDate] NOT BETWEEN @p1_start AND @p1_end
	
@p1_start (DateTime) = 01/01/1753 00:00:00
@p1_end (DateTime) = 26/06/2012 13:49:54</pre>
<p class="alert">[ADOAdapter Only]</p>
<p>Note that Simple.Data will throw a <code class="type">System.Data.SqlTypes.SqlTypeException</code> if the dates in the range are not valid SQL dates.</p>
</body>
</html>